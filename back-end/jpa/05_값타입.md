## âœ”ï¸ ê¸°ë³¸ê°’ íƒ€ì…

### ğŸ”¨ JPAì˜ ë°ì´í„° íƒ€ì… ë¶„ë¥˜

- **ì—”í‹°í‹° íƒ€ì…**
  - @Entityë¡œ ì •ì˜í•˜ëŠ” ê°ì²´
  - ë°ì´í„°ê°€ ë³€í•´ë„ ì‹ë³„ìë¡œ ì§€ì†í•´ì„œ ì¶”ì  ê°€ëŠ¥
  - ì˜ˆ) íšŒì› ì—”í‹°í‹°ì˜ í‚¤ë‚˜ ë‚˜ì´ ê°’ì„ ë³€ê²½í•´ë„ ì‹ë³„ìë¡œ ì¸ì‹ ê°€ëŠ¥
- **ê°’ íƒ€ì…**
  - int, Integer, String ì²˜ëŸ¼ ë‹¨ìˆœíˆ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìë°” ê¸°ë³¸ íƒ€ì…ì´ë‚˜ ê°ì²´
  - ì‹ë³„ìê°€ ì—†ê³  ê°’ë§Œ ìˆìœ¼ë¯€ë¡œ ë³€ê²½ì‹œ ì¶”ì  ë¶ˆê°€
  - ì˜ˆ) ìˆ«ì 100ì„ 200ìœ¼ë¡œ ë³€ê²½í•˜ë©´ ì™„ì „íˆ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ëŒ€ì²´
- **ê°’ íƒ€ì… ë¶„ë¥˜**
  - **ê¸°ë³¸ê°’ íƒ€ì…** : ìƒëª… ì£¼ê¸°ë¥¼ ì—”í‹°í‹°ì— ì˜ì¡´, ê°’ íƒ€ì…ì€ ê³µìœ í•˜ë©´ ì•ˆë¨
    - ìë°” ê¸°ë³¸ íƒ€ì…(int, double)
    - ë˜í¼ í´ë˜ìŠ¤(Integer, Long)
    - String
  - **ì„ë² ë””ë“œ íƒ€ì…** (embedded type, ë³µí•© ê°’ íƒ€ì…)
    - @Embeddable : ê°’ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ê³³ì— í‘œì‹œ
    - @Embedded : ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ê³³ì— í‘œì‹œ
    - ê¸°ë³¸ ìƒì„±ì í•„ìˆ˜
  - **ì»¬ë ‰ì…˜ ê°’ íƒ€ì…** (collection value type)



## âœ”ï¸ ê°’ íƒ€ì… ì»¬ë ‰ì…˜

- ê°’ íƒ€ì…ì„ í•˜ë‚˜ ì´ìƒ ì €ì¥í•  ë•Œ ì‚¬ìš©
- @ElementCollection, @CoolectionTable ì‚¬ìš©
- ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì»¬ë ‰ì…˜ì„ ê°™ì€ í…Œì´ë¸”ì— ì €ì¥í•  ìˆ˜ ì—†ë‹¤
- ì»¬ë ‰ì…˜ì„ ì €ì¥í•˜ê¸° ìœ„í•œ ë³„ë„ì˜ í…Œì´ë¸”ì´ í•„ìš”í•¨

```java
@Entity
public class Member {
  @Id
  @GeneratedValue
  @Column(name = "MEMBER_ID")
  private Long id;
  
  @Column(name = "USERNAME")
  private String username;
  
  @Embedded
  private Address homeAddress;
  
  @ElementCollection // ë§¤í•‘
  @CollectionTable(name = "FAVORITE_FOOD", joinColumns =
                  @JoinColumn(name="MEMBER_ID")
                  )
  @Column(name="FOOD_NAME")
  private Set<String> favoriteFoods = new HashSet<>();
  
  @ElementCollection // ë§¤í•‘
  @CollectionTable(name = "ADDRESS", joinColumns =
                  @JoinColumn(name="MEMBER_ID")
                  )
  private List<Address> addressHistory = new ArrayList<>();
  
}
```



- **FAVORITE_FOOD**

  ```sql
  create table FAVORITE_FOOD (
  	MEMBER_ID bigint not null,
    FOOD_NAME varchar(255)
  )
  ```



### ğŸ”¨ ì‚¬ìš©í•´ë³´ê¸°

- **ê°’ íƒ€ì… ì €ì¥**

  ```java
  Member member = new Member();
  member.setUsername("member1");
  member.setHomeAddress(new Address("city1", "street", "100000"));
  member.getFavoriteFoods().add("ì¹˜í‚¨");
  member.getFavoriteFoods().add("ì¡±ë°œ");
  member.getFavoriteFoods().add("í”¼ì");
  
  member.getAddressHistory().add(new Address("old1","street","10000"))
  ```

- **ê°’ íƒ€ì… ì¡°íšŒ**

  ```java
  Member findMember = em.find(Member.class, member.getId());
  // ê°’ íƒ€ì… ì»¬ë ‰ì…˜ë„ ì§€ì—° ë¡œë”© ì „ëµì„ ì‚¬ìš©í•œë‹¤
  List<Address> findMember.getAddressHistory = findMember.getAddressHIstory();
  ```

- **ê°’ íƒ€ì… ìˆ˜ì •**

  ```java
  // homeCity -> newCity
  // ê°’ íƒ€ì…ì€ í†µì¨°ë¡œ ê°ˆì•„ê»´ì•¼í•œë‹¹
  findMember.setHomeAdress(new Address("newCity", a.getStreet(), a.getZipcode()));
  
  // ì¹˜í‚¨ì„ í•œì‹ìœ¼ë¡œ
  findMember.getFavoriteFoods().remove("ì¹˜í‚¨");
  findMember.getFavoriteFoods().add("í•œì‹");
  
  findMember.getAddressHistory().remove(new Address("old1", "street", "10000"));
  findMember.getAddressHisotry().add(new Address("newCity1", "street", "10000"));
  ```



### ğŸ”¨ ì œì•½ì‚¬í•­

- ê°’ íƒ€ì…ì€ ì—”í‹°í‹°ì™€ ë‹¤ë¥´ê²Œ ì‹ë³„ì ê°œë…ì´ ì—†ë‹¤
- ê°’ì€ ë³€ê²½í•˜ë©´ ì¶”ì ì´ ì–´ë µë‹¤.
- ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì— ë³€ê²½ ì‚¬í•­ì´ ë°œìƒí•˜ë©´, ì£¼ì¸ ì—”í‹°í‹°ì™€ ì—°ê´€ëœ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³ , ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì— ìˆëŠ” í˜„ì¬ ê°’ì„ ëª¨ë‘ ë‹¤ì‹œ ì €ì¥í•œë‹¤.
- ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì„ ë§¤í•‘í•˜ëŠ” í…Œì´ë¸”ì€ ëª¨ë“  ì»¬ëŸ¼ì„ ë¬¶ì–´ì„œ ê¸°ë³¸í‚¤ë¥¼ êµ¬ì„±í•´ì•¼ í•¨ : null ì…ë ¥ X, ì¤‘ë³µ ì €ì¥ X



### ğŸ”¨ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ëŒ€ì•ˆ

- ì‹¤ë¬´ì—ì„œëŠ” ìƒí™©ì— ë”°ë¼ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ëŒ€ì‹ ì— ì¼ëŒ€ë‹¤ ê´€ê³„ë¥¼ ê³ ë ¤
- ì¼ëŒ€ë‹¤ ê´€ê³„ë¥¼ ìœ„í•œ ì—”í‹°í‹°ë¥¼ ë§Œë“¤ê³  ì—¬ê¸°ì„œ ê°’ íƒ€ì…ì„ ì ìš©
- ì˜ì†ì„± ì „ì´(Cascade) + ê³ ì•„ ê°ì²´ ì œê±°ë¥¼ ì‚¬ìš©í•´ì„œ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì²˜ëŸ¼ ì‚¬ìš©

```java
@Entity
public class AddressEntity {
  @Id @GeneratedValue
  private Long id;
  
  private Address address;
}
	
	
@Entity
public class Member{
  
  // ....
  
  @OneToMany(casacde = CascadeType.ALL, orphanRemoval = true)
  @JoinColumn(name)
  private List<AddressEntity> addressHistory = new ArrayLlist<>();
}
```



