# 1.4 ë„ë©”ì¸ ëª¨ë¸ íŒ¨í„´

## ì•„í‚¤í…ì²˜ êµ¬ì„±

| ì˜ì—­                        | ì„¤ëª…                                                         |
| --------------------------- | ------------------------------------------------------------ |
| ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ë˜ëŠ” í‘œí˜„ | ì‚¬ìš©ìì˜ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  ì‚¬ìš©ìì—ê²Œ ì •ë³´ë¥¼ ë³´ì—¬ì¤Œ. ì—¬ê¸°ì„œ ì‚¬ìš©ìëŠ” ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‚¬ëŒë¿ë§Œ ì•„ë‹ˆë¼ ì™¸ë¶€ ì‹œìŠ¤í…œì¼ ìˆ˜ë„ ìˆìŒ |
| ì‘ìš©                        | ì‚¬ìš©ìê°€ ìš”ì²­í•˜ëŠ” ê¸°ëŠ¥ì„ ì‹¤í–‰í•¨. ì—…ë¬´ ë¡œì§ì„ ì§ì ‘ êµ¬í˜„í•˜ì§€ ì•Šìœ¼ë©° ë„ë©”ì¸ ê³„ì¸µì„ ì¡°í•©í•˜ì—¬ ê¸°ëŠ¥ì„ ì‹¤í–‰ |
| ë„ë©”ì¸                      | ì‹œìŠ¤í…œì´ ì œê³µí•  ë„ë©”ì¸ ê·œì¹™ì„ êµ¬í˜„                           |
| ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜              | ë°ì´í„°ë² ì´ìŠ¤ë‚˜ ë©”ì‹œì§• ì‹œìŠ¤í…œê³¼ ê°™ì€ ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ì˜ ì—°ë™ì„ ì²˜ë¦¬ |

- ë„ë©”ì¸ ëª¨ë¸ì€ ì•„í‚¤í…ì²˜ ìƒì˜ ë„ë©”ì¸ ê³„ì¸µì„ ê°ì²´ ê¸°í–¥ ê¸°ë²•ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” íŒ¨í„´ì„ ë§í•œë‹¤.
- ë„ë©”ì¸ ê³„ì¸µì€ ë„ë©”ì¸ì˜ í•µì‹¬ ê·œì¹™ì„ êµ¬í˜„
  - e.g ì£¼ë¬¸ ë„ë©”ì¸ 
    - ì¶œê³  ì „ì— ë°°ì†¡ì§€ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤
    - ì£¼ë¬¸ ì·¨ì†ŒëŠ” ë°°ì†¡ ì „ì—ë§Œ í•  ìˆ˜ ìˆë‹¤

```java
public class Order {
    private OrderState state;
    private ShippingInfo shippingInfo;
    
    // ì‹¤ì œ ë°°ì†¡ì§€ ì •ë³´ë¥¼ ë³€ê²½
    public void changeShippingInfo(ShippingInfo newShippingInfo) {
        if (!state.isShippingCHangeable()) {
            throw new IllegalStateException("can't change shipping in " + state);
        }
        this.shippingInfo = new ShippingInfo;
    }
}

public enum OrderState {
    PAYMENT_WAITING {
        public boolean isSHippingCHangeable() {
            return true;
        }
    },
    PREPARING {
        public boolean isShippingChangeable() {
            return true;
        }
    },
    SHIPPED, DELIVERING, DELIVERY_COMPLETED;
    
    public boolean isShippingChangeable() {
        return false;
    }
}
```

- OrderStateëŠ” Orderì— ì†í•œ ë°ì´í„°ë¯€ë¡œ ë°°ì†¡ì§€ ì •ë³´ ë³€ê²½ ê°€ëŠ¥ ì—¬ë¶€ íŒë‹¨ ë¡œì§ì„ Orderë¡œ ì´ë™í•  ìˆ˜ ìˆìŒ

```java
public class Order{
    private OrderState state;
    private ShippingInfo shippingInfo;
    
    public void changeShippingInfo(ShippingInfo newShippingInfo) {
        if (!state.isShippingCHangeable()) {
            throw new IllegalStateException("can't change shipping in " + state);
        }
        this.shippingInfo = new ShippingInfo;
    }
    
    private boolean isShippingChangeable() {
        return state == OrderState.PAYMENT_WATTING ||
            state == OrderState.PREPARING;
    }
    
    public enum OrderState{
        PAYMENT_WATTING,PREPARING,SHIPPED,DELIVERING,DELIVERY_COMPLETED;
    }
}
```



- ì£¼ë¬¸ê³¼ ê´€ë ¨ëœ ì¤‘ìš” ì—…ë¬´ ê·œì¹™ -> ì£¼ë¬¸ ë„ë©”ì¸ ëª¨ë¸ì¸ Orderë‚˜ OrderStateì—ì„œ êµ¬í˜„
- í•µì‹¬ ê·œì¹™ì„ êµ¬í˜„í•œ ì½”ë“œëŠ” ë„ë©”ì¸ ëª¨ë¸ì—ë§Œ ìœ„ì¹˜í•˜ê¸° ë•Œë¬¸ì—, ê·œì¹™ì´ ë°”ë€Œê±°ë‚˜ ê·œì¹™ì„ í™•ì¥í•´ì•¼ í•  ë•Œ ë‹¤ë¥¸ ì½”ë“œì— ì˜í–¥ì„ ëœ ì£¼ê³  ë³€ê²½ ë‚´ì—­ì„ ëª¨ë¸ì— ë°˜ì˜í•  ìˆ˜ ìˆê²Œ ëœë‹¤



# 1.5 ë„ë©”ì¸ ëª¨ë¸ ë„ì¶œ

ë„ë©”ì¸ì„ ëª¨ë¸ë§í•  ë•Œ ê¸°ë³¸ì´ ë˜ëŠ” ì‘ì—…ì€ ëª¨ë¸ì„ êµ¬ì„±í•˜ëŠ” í•µì‹¬ êµ¬ì„±ìš”ì†Œ, ê·œì¹™, ê¸°ëŠ¥ì„ ì°¾ëŠ” ê²ƒì´ë‹¤. ì´ ê³¼ì •ì€ **ìš”êµ¬ì‚¬í•­**ì—ì„œ ì¶œë°œí•œë‹¤.

## e. g ì£¼ë¬¸ ë„ë©”ì¸ê³¼ ê´€ë ¨ëœ ëª‡ ê°€ì§€ ìš”êµ¬ì‚¬í•­

- ìµœì†Œ í•œ ì¢…ë¥˜ ì´ìƒì˜ ìƒí’ˆì„ ì£¼ë¬¸í•´ì•¼ í•¨
- í•œ ìƒí’ˆì„ í•œ ê°œ ì´ìƒ ì£¼ë¬¸í•  ìˆ˜ ìˆìŒ
- ì´ ì£¼ë¬¸ ê¸ˆì•¡ì€ ê° ìƒí’ˆì˜ êµ¬ë§¤ ê°€ê²© í•©ì„ ëª¨ë‘ ë”í•œ ê¸ˆì•¡ì„
- ê° ìƒí’ˆì˜ êµ¬ë§¤ ê°€ê²© í•©ì€ ìƒí’ˆ ê°€ê²©ì— êµ¬ë§¤ ê°œìˆ˜ë¥¼ ê³±í•œ ê°’ì„
- ì£¼ë¬¸í•  ë•Œ ë°°ì†¡ì§€ ì •ë³´ë¥¼ ë°˜ë“œì‹œ ì§€ì •í•´ì•¼ í•¨
- ë°°ì†¡ì§€ ì •ë³´ëŠ” ë°›ëŠ” ì‚¬ëŒ ì´ë¦„, ì „í™”ë²ˆí˜¸, ì£¼ì†Œë¡œ êµ¬ì„±ë¨
- ì¶œê³ ë¥¼ í•˜ë©´ ë°°ì†¡ì§€ë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ìŒ
- ì¶œê³  ì „ì— ì£¼ë¬¸ì„ ì·¨ì†Œí•  ìˆ˜ ìˆìŒ
- ê³ ê°ì— ê²°ì œë¥¼ ì™„ë£Œí•˜ê¸° ì „ì—ëŠ” ìƒí’ˆì„ ì¤€ë¹„í•˜ì§€ ì•ŠëŠ”ë‹¤

### ğŸ‘‰ â€˜ì£¼ë¬¸â€™ ê¸°ëŠ¥ ë„ì¶œ

- ì£¼ë¬¸ì€ `ì¶œê³  ìƒíƒœë¡œ ë³€ê²½í•˜ê¸°` , `ë°°ì†¡ì§€ ì •ë³´ ë³€ê²½í•˜ê¸°`, `ì£¼ë¬¸ ì·¨ì†Œí•˜ê¸°` , `ê²°ì œ ì™„ë£Œí•˜ê¸°` ê¸°ëŠ¥ì„ ì œê³µ

```java
public class Order {
  public void changeShipped() {...}
  public void changeShippingInfo(ShippingInfo newShipping) {...}
  public void cancel() {...}
  public void completePayment() {...}
}
```

### ğŸ‘‰ 'ì£¼ë¬¸ í•­ëª©'ê¸°ëŠ¥ ë„ì¶œ

- í•œ ìƒí’ˆì„ í•œ ê°œ ì´ìƒ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤.
- **ê° ìƒí’ˆ**ì˜ êµ¬ë§¤ ê°€ê²© í•©ì€ **ìƒí’ˆ ê°€ê²©**ì— **êµ¬ë§¤ ê°œìˆ˜**ë¥¼ ê³±í•œ ê°’ì´ë‹¤.

â†’ `OrderLine(ì£¼ë¬¸ í•­ëª©)`  : ì£¼ë¬¸í•  ìƒí’ˆ, ìƒí’ˆì˜ ê°€ê²©, êµ¬ë§¤ ê°œìˆ˜ë¥¼ í¬í•¨í•´ì•¼í•¨

```java
public class OrderLine {
  private Product product; // ì£¼ë¬¸í•  ìƒí’ˆ
  private int price;			 // ìƒí’ˆì˜ ê°€ê²©
  private int quantity;		 // êµ¬ë§¤ ê°œìˆ˜
  private int amounts;		 // ê° êµ¬ë§¤ í•­ëª©ì˜ êµ¬ë§¤ ê°€ê²©
  
  public OrderLine(Product product, int price, int qunatity) {
    this.product = product;
    this.price = price;
    this.quantity = quantity;
    this.amount = calcuateAmounts();
  }
  
  private int calculateAmounts() {
    return price * quantity;
  }
  
  public int getAmounts() {...}
  
}
```

### ğŸ‘‰ ë‹¤ìŒ ìš”êµ¬ì‚¬í•­ì€ Orderì™€ OrderLineê³¼ì˜ ê´€ê³„ë¥¼ ì•Œë ¤ì¤€ë‹¤.

- ìµœì†Œ 

  **í•œ ì¢…ë¥˜ ì´ìƒì˜ ìƒí’ˆ**

  ì„ ì£¼ë¬¸í•´ì•¼ í•œë‹¤.

  - `Order` ëŠ” **ìµœì†Œ í•œ ê°œ ì´ìƒ**ì˜ `OrderLine` ì„ í¬í•¨í•´ì•¼ í•¨ -> List

- ì´ ì£¼ë¬¸ ê¸ˆì•¡ì€ ê° ìƒí’ˆì˜ êµ¬ë§¤ ê°€ê²© í•©ì„ ëª¨ë‘ ë”í•œ ê¸ˆì•¡ì´ë‹¤.

  - ì´ ì£¼ë¬¸ ê¸ˆì•¡ì€ `OrderLine` ì—ì„œ êµ¬í•  ìˆ˜ ìˆìŒ

```java
public class Order {
  private List<OrderLine> orderLines; // í•œ ê°œ ì´ìƒì˜ OrderLineì„ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ã…¡ë¡œ Listë¡œ ì „ë‹¬
  private Money totalAmounts; 
  
  public Order(List<OrderLine> orderLines) {
    setOrderLines(orderLines);
  }
  
  private void setOrderLines(List<OrderLine> orderLines) {
    verifyAtLeastOneOrMoreOrderLines(orderLines); // ìš”êµ¬ì‚¬í•­ì— ì •ì˜í•œ ì œì•½ ì¡°ê±´ì„ ê²€ì‚¬
    this.orderLines = orderLlines;
    calculateTotalAmounts();
  }
  
  // ìµœì†Œ í•œ ì¢…ë¥˜ ì´ìƒì˜ ìƒí’ˆì„ ì£¼ë¬¸í•´ì•¼í•œë‹¤ëŠ” ì œì•½ì¡°ê±´ì„ ê²€ì‚¬í•˜ëŠ” ë©”ì†Œë“œ
  private void verifyAtLeastOneOrMoreOrderLines(List<OrderLines> orderLines) {
    if (orderLInes == null || orderLines.isEmpty()) {
      thorw new IllegalArgumentsException("no OrderLines");
    }
  }
  
  // ì´ ì£¼ë¬¸ ê¸ˆì•¡ì„ ê³„ì‚°
  private void calculateTotalAmounts() {
    int sum = orderLines.stream()
      .mapToInt(x->x.getAmounts())
      .sum();
    
    this.totalAmounts = new Money(sum);
  }
  
  public void changeShipped() {...}
  public void changeShippingInfo(ShippingInfo newShipping) {...}
  public void cancel() {...}
  public void completePayment() {...}
}
```

### ğŸ‘‰ ë°°ì†¡ì§€ ì •ë³´ëŠ” ì´ë¦„, ì „í™”ë²ˆí˜¸, ì£¼ì†Œ ë°ì´í„°ë¥¼ ê°€ì§„ë‹¤

- `ShippingInfo` í´ë˜ìŠ¤ ì •ì˜

```java
public clas ShippingInfo {
  private String receiverName; // ì´ë¦„
  private String receiverPhoneNumber; // ì „í™”ë²ˆí˜¸
  private String shippingAddress1; // ì£¼ì†Œ
  private String shippingAddress2;
  private String shippingZipcode;
}
```

### ğŸ‘‰ ì£¼ë¬¸í•  ë•Œ ë°°ì†¡ì§€ ì •ë³´ë¥¼ ë°˜ë“œì‹œ ì§€ì •í•´ì•¼ í•œë‹¤

- `Order`ë¥¼ ìƒì„±í•  ë•Œ `OrderLine` ì˜ ëª©ë¡ë¿ë§Œ ì•„ë‹ˆë¼ `ShippingInfo` ë„ í•¨ê»˜ ì „ë‹¬í•´ì•¼ í•¨ì„ ì˜ë¯¸í•œë‹¤
- ì´ë¥¼ ìƒì„±ìì— ë°˜ì˜í•˜ì

```java
public class Order {
  private List<OrderLine> orderLines; 
	private ShippingInfo shippingInfo;
  ...
    
  public Order(List<OrderLine> orderLines, ShippingInfo shippingInfo) {
    setOrderLines(orderLines);
    setShippingInfo(shippingInfo);
  }
  
  private void setShippingInfo(ShippingInfo shippingInfo) {
    if (shippingInfo == null) 
			// 'ë°°ì†¡ì§€ ì •ë³´ í•„ìˆ˜' ë¼ëŠ” ë„ë©”ì¸ ê·œì¹™ êµ¬í˜„
      throw new IllegalArgumentException("no ShippingInfo");
    this.shippingInfo = shippingInfo;
  }
  ...
}
```

# 1.6 ì—”í‹°í‹°ì™€ ë²¨ë¥˜

## 1.6.1. ì—”í‹°í‹°

- ì—”í‹°í‹°ëŠ” **ì‹ë³„ì**ë¥¼ ê°€ì§„ë‹¤. ì‹ë³„ìëŠ” ì—”í‹°í‹° ê°ì²´ë§ˆë‹¤ ê³ ìœ í•´ì„œ ê° ì—”í‹°í‹°ëŠ” ì„œë¡œ ë‹¤ë¥¸ ì‹ë³„ìë¥¼ ê°–ëŠ”ë‹¤.
- ì—”í‹°í‹°ì˜ ì‹ë³„ìëŠ” ê³ ìœ í•˜ê¸° ë•Œë¬¸ì— ë‘ ì—”í‹°í‹° ê°ì²´ì˜ ì‹ë³„ìê°€ ê°™ìœ¼ë©´ ë‘ ì—”í‹°í‹°ëŠ” ê°™ë‹¤ê³  íŒë‹¨í•  ìˆ˜ ìˆë‹¤.
- ì—”í‹°í‹°ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ëŠ” ì‹ë³„ìë¥¼ ì´ìš©í•´ì„œ equals() ë©”ì„œë“œì™€ hashCode() ë©”ì„œë“œë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

## 1.6.2 ì—”í‹°í‹°ì˜ ì‹ë³„ì ìƒì„±

- ì—”í‹°í‹°ì˜ ì‹ë³„ìë¥¼ ìƒì„±í•˜ëŠ” ì‹œì ì€ ë„ë©”ì¸ì˜ íŠ¹ì§•ê³¼ ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤.
- ì‹ë³„ìëŠ” ë‹¤ìŒ ì¤‘ í•œ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ìƒì„±í•œë‹¤.
  - íŠ¹ì • ê·œì¹™ì— ë”°ë¼ ìƒì„±
  - UUIDë‚˜ Nano Idì™€ ê°™ì€ ê³ ìœ  ì‹ë³„ì ìƒì„±ê¸° ì‚¬ìš©
  - ê°’ì„ ì§ì ‘ ì…ë ¥
  - ì¼ë ¨ë²ˆí˜¸ ì‚¬ìš© (ì‹œí€€ìŠ¤ë‚˜ DBì˜ ìë™ ì¦ê°€ ì¹¼ëŸ¼ ì‚¬ìš©)

## 1.6.3 ë°¸ë¥˜íƒ€ì…

- ê°œë…ì ìœ¼ë¡œ **ì™„ì „í•œ í•˜ë‚˜ë¥¼ í‘œí˜„**í•  ë•Œ ì‚¬ìš©
- e.g ShippingInfo í´ë˜ìŠ¤

```java
// ë°°ì†¡ì§€ ì •ë³´
public class ShippingInfo {
//    private String receiverName;
//    private String receiverPhoneNumber;
//    private String shippingAddress1;
//    private String shippingAddress2;
//    private String shippingZipcode;

    private Receiver receiver;
    private Address address;
}
```

- ë°¸ë¥˜ ê°ì²´ì˜ ë°ì´í„°ë¥¼ ë³€ê²½í•  ë–„ëŠ” ê¸°ì¡´ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ê¸°ë³´ë‹¤ëŠ” ë³€ê²½í•œ ë°ì´í„°ë¥¼ ê°–ëŠ” ìƒˆë¡œìš´ ë°¸ë¥˜ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë°©ì‹ì„ ì„ í˜¸

```java
public Money add(Money money) {
    return new Money(this.value + money.value);
}
```

- Moneyì²˜ëŸ¼ ë°ì´í„° ë³€ê²½ ê¸°ëŠ¥ì„ ì œê³µí•˜ì§€ ì•ŠëŠ” íƒ€ì…ì„ ë¶ˆë³€(immutable)ë¼ê³  í‘œí˜„í•œë‹¤.
  - ë°¸ë¥˜ íƒ€ì…ì„ ë¶ˆë³€ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” ê°€ì¥ ì¤‘ìš”í•œ ì´ìœ ëŠ” ì•ˆì „í•œ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤ëŠ” ë° ìˆë‹¤

```java
public class Money {
    private int value;

    public Money(int value) {
        this.value = value;
    }

    public Money add(Money money) {
        return new Money(this.value + money.value);
    }

    public Money multiply(int multiplier) {
        return new Money(value * multiplier);
    }
    
    // valueë¥¼ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œ ì—†ìŒ
 }
```

## 1.6.4 ì—”í‹°í‹° ì‹ë³„ìì™€ ë°¸ë¥˜íƒ€ì…

- ì—”í‹°í‹° ì‹ë³„ìì˜ ì‹¤ì œ ë°ì´í„°ëŠ” Stringê³¼ ê°™ì€ ë¬¸ìì—´ë¡œ êµ¬ì„±ëœ ê²½ìš°ê°€ ë§ë‹¤.
- ì‹ë³„ìëŠ” ë‹¨ìˆœí•œ ë¬¸ìì—´ì´ ì•„ë‹ˆë¼ ë„ë©”ì¸ì—ì„œ íŠ¹ë³„í•œ ì˜ë¯¸ë¥¼ ì§€ë‹ˆëŠ” ê²½ìš°ê°€ ë§ê¸° ë•Œë¬¸ì— ì‹ë³„ìë¥¼ ìœ„í•œ ë°¸ë¥˜ íƒ€ì…ì„ ì‚¬ìš©í•´ì„œ ì˜ë¯¸ê°€ ì˜ ë“œëŸ¬ë‚˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.
- Orderì˜ ì‹ë³„ì íƒ€ì… String â†’ OrderNo ë°¸ë¥˜ íƒ€ì… ì‚¬ìš©

## 1.6.5 ë„ë©”ì¸ ëª¨ë¸ì— set ë©”ì„œë“œ ë„£ì§€ ì•Šê¸°

- set ë©”ì„œë“œëŠ” ë„ë©”ì¸ì˜ í•µì‹¬ ê°œë…ì´ë‚˜ ì˜ë„ë¥¼ ì½”ë“œì—ì„œ ì‚¬ë¼ì§€ê²Œ í•œë‹¤.
- ë„ë©”ì¸ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì˜¨ì „í•˜ì§€ ì•Šì€ ìƒíƒœê°€ ë  ìˆ˜ ìˆë‹¤.
- ë„ë©”ì¸ ê°ì²´ê°€ ë¶ˆì™„ì „í•œ ìƒíƒœë¡œ ì‚¬ìš©ë˜ëŠ” ê²ƒì„ ë§‰ìœ¼ë ¤ë©´ ìƒì„± ì‹œì ì— í•„ìš”í•œ ê²ƒì„ ì „ë‹¬í•´ ì£¼ì–´ì•¼ í•œë‹¤. â‡’ ìƒì„±ìë¥¼ í†µí•´ í•„ìš”í•œ ë°ì´í„°ë¥¼ ëª¨ë‘ ë°›ì
