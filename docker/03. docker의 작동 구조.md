# 1. 컨테이너 기술의 개요

## 컨테이너

- 컨테이너란 호스트 OS상에 논리적인 구획(컨테이너)를 만들고, 애플리케이션을 작동시키기 위해 플요한 라이브러리나 애플리케이션 등을 하나로 모아 마치 별도의서버인 것처럼 사용할 수 있게 만든 것
- 호스트 OS의 리소스를 논리적으로 분리시키고, 여러 개의 컨테이너가 공유하여 사용
- 컨테이너는 오버헤드가 적기 때문에 가볍고 고속으로 작동한다는 것이 특징

| 물리 서버                                                    | 컨테이너                                                     |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 하나의 OS 상에서 움직이는 여러 애플리케이션은 똑같은 시스템 리소스를 사용<br />-> 이때 작동하는 여러 애플리케이션은 데이터를 저장하는 디렉토리를 공유하고, 서버에 설정된 동일한 IP 주소로 통신<br />-> 여러 어플리케이션에서 사용하고 있는 미들웨어나 라이브러리의 버전이 다른 경우에는 각 애플리케이션이 서로 영향을 받지 않도록 주의해야 함 | - OS나 디렉토리, IP 주소 등과 같은 시스템 자원을 마치 각 애플리케이션이 점유하고 있는 것처럼 보이게 할 수 있음<br />- 컨테이너는 애플리케이션의 실행에 필요한 모듈을 컨테이너로 모을 수 있기 때문에 여러 개의 컨테이너를 조합하여 하나의 애플리케이션을 구축하는 마이크로 서비스형 애플리케이션과 친화성이 높음 |



# 2. Docker의 개요

- 도커는 애플리케이션의 실행에 필요한 환경을 하나의 이미지로 모아두고, 그 이미지를 사용하여 다양한 환경에서 애플리케이션 실행 환경을 구축 및 운용하기 위한 오픈소스 플랫폼



## Docker란

- 웹 시스템 개발 시 애플리케이션을 제품 환경에서 가동시키기 위해 필요한 요소들
  - 애플리케이션의 실행 모듈(프로그램 본체)
  - 미들웨어나 라이브러리군
  - OS/네트워크 등과 같은 인프라 환경 설정
- Docker에서는 이러한 인프라 환경을 컨테이너로 관리
  - 애플리케이션의 실행에 필요한 모든 파일 및 디렉토리들을 컨테이너로서 모아버림
  - 이러한 컨테이너의 바탕이 되는 Docker 이미지를 Docker Hub와 같은 리포지토리에서 공유



# 3. Docker의 기능

- Docker의 세 가지 기능
  - Docker 이미지를 만드는 기능 (Build)
  - Docker 이미지를 공유하는 기능 (Ship)
  - Docker 컨테이너를 작동시키는 기능 (Run



## Docker 이미지를 만드는 기능 (Build)

- Docker는 애플리케이션의 실행에 필요한 프로그램 본체, 라이브러리, 미들웨어, OS나 네트워크 설정 등을 하나로 모아서 Docker 이미지를 만듦
- Docker 이미지는 실행 환경에서 움직이는 컨테이너의 바탕이 됨
- Docker에서는 하나의 이미지에는 하나의 애플리케이션만 넣어 두고, 여러 개의 컨테이너를 조합하여 서비스를 구축하는 방법을 권장하고 있음
- Docker 이미지
  - 애플리케이션의 실행에 필요한 파일들이 저장된 디렉토리
  - Docker의 명령을 사용하여 수동으로 만들거나, Dockerfile이라는 설정 파일을 만들어 그것을 바탕으로 자동으로 이미지를 만들 수도 있다
- Docker 이미지는 겹쳐서 사용할 수 있음
  - OS용 이미지 + 웹 애플리케이션용 이미지 => 새로운 이미지



## Docker 이미지를 공유하는 기능 (Ship)

- Docker 이미지는 Docker 레지스트리에서 공유할 수 있음
- Docker  Hub에서는 Ubuntu나 CentOS와 같은 Linux 배포판의 기본 기능을 제공하는 베이스 이미지를 배포하고 있음
- 이 베이스 이미지에 미들웨어나 라이브러리, 애플리케이션 등을 넣은 이미지를 겹쳐 독자적인 Docker 이미지를 만들어 가는 것



## Docker 컨테이너를 작동시키는 기능 (Run)

- Docker는 Linux상에서 컨테이너 단위로 서버 기능을 작동시킴
- Docker 이미지만 있으면 Docker가 설치된 환경이라면 어디서든지 컨테이너를 작동시킬 수 있음. 
- 또한 Docker 이미지를 가지고 여러 개의 컨테이너를 기동시킬 수 있음
- Docker는 하나의 Linux 커널을 여러 개의 컨테이너에서 공유하고 있다
  - 이러한 구조를 사용해 컨테이너를 독림된 공간으로 관리하고 있음 -> Linux 커널 기능 기술 사용



# 4. Docker의 작동 구조

## 컨테이너를 구획화하는 장치 (namespace)

- namespace : 이름 공간
  - 한 덩어리의 데이터에 이름을 붙여 분할함으로써 충돌 가능성을 줄이고, 쉽게 찾모할 수 있게 하는 개념
  - 이름과 연결된 실체는 그 이름이 어떤 이름공간에 속해 있는지 고유하게 정해짐
- namepsace 기능은 Linux의 오브젝트에 이름을 붙임으로써 다음과 같은 독립환경 구축 가능
  - PID namespace
    - 리눅스에서 각 프로세스에 할당한 고유한 ID를 말함
    - namespace가 다른 프로세스끼리는 서로 액세스할 수 없음
  - Network namespace
    - 네트워크 디바이스, IP주소, 포트 번호, 라우팅 테이블, 필터링 테이블 등과 같은 네트워크 리소스를 격리된 namespace마다 독립적으로 가질 수 있음
    - 이 기능을 사용하면 호스트 OS 상에서 사용 중인 포트가 있떠라도 컨테이너 안에서 동일한 번호의 포트를 사용할 수 있다
  - UID namepsace
    - UID(사용자 ID), GID(그룹 ID)를 namepsaceㅂ	ㅕㄹ로 독립적으로 가질 수 있ㅇㅇ틈
  - MOUNT namespace
    - 마운트 : 컴퓨터에 연결된 기기나 기억장치를 OS에 인식시켜 이용 가능한 상태로 만드는 것
  - UTS namespace
    - 네임스페이스 별로 호스트명이나 도메인명을 독자적으로 가질 수 있음
  - IPC namespace
    - 프로세스 간의 통신 오브젝트를 네임스페이스별로 독립적으로 가질 수 있음



## 릴리스 관리 장치(cgroups)

- 리눅스에서는 프로그램을 프로세스로서 실행함
  - 프로세스는 하나 이상의 스레드 모음으로 움직임
- croups는 프로세스와 스레드를 그룹화하여, 그 그룹 안에 존재하는 프로세스와 스레드에 대한 관리를 수행하기 위한 기능
- ex. 호스트 OS의 CPUS나 메모리와 같은 자원에 대해 그룹별로 제한으 ㄹ둘 수 있음
